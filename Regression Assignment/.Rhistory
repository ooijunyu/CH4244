library(tidyverse)
library(tidyverse)
install.packages("tidyverse")
library(tidyverse)
library(tidyverse)
install.packages("magrittr")
library(dplyr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(tibble)
library(dplyr)
library(tidyr)
library(ggplot2)
library(tibble)
library(magrittr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(tibble)
library(magrittr)
data <- read_csv("Advertising.csv")
library(dplyr)
library(tidyr)
library(ggplot2)
library(tibble)
library(magrittr)
library(xlsx)
library(xlxs)
library(readr)
data <- read_csv("Advertising.csv")
str(data)
str(data)
summary(data)
?hist()
attach(data)
par(c(2,2))
hist(TV)
hist(radio)
hist(newspaper)
hist(Sales)
?par()
par(mfrow = c(2,2))
hist(TV)
hist(radio)
hist(newspaper)
hist(Sales)
?hist
par(mfrow = c(2,2))
hist(TV,10)
hist(radio)
hist(newspaper)
hist(Sales)
?hist
par(mfrow = c(2,2))
hist(TV,breaks = 10)
hist(radio)
hist(newspaper)
hist(Sales)
?hist
par(mfrow = c(2,2))
hist(TV,breaks = seq(0,300,10))
hist(radio)
hist(newspaper)
hist(Sales)
?hist
par(mfrow = c(2,2))
hist(TV,breaks = seq(0,300,20))
hist(radio)
hist(newspaper)
hist(Sales)
?hist
par(mfrow = c(2,2))
hist(TV,breaks = seq(0,300,50))
hist(radio)
hist(newspaper)
hist(Sales)
?hist
par(mfrow = c(2,2))
hist(TV,breaks = seq(0,300,30))
hist(radio)
hist(newspaper)
hist(Sales)
?hist
par(mfrow = c(1,3))
plot(TV,Sales)
plot(radio,Sales)
plot(newspaper,Sales)
par(mfrow = c(1,3))
plot(TV, Sales, main = "Sales vs TV")
plot(radio, Sales, main = "Sales vs radio")
plot(newspaper, Sales, main = "Sales vs newspaper")
set.seed(100)
data <- select(Sales,TV,radio,newspaper) %>%
mutate(nSales = (Sales - min(Sales))/(max(Sales)-min(Sales)),
nTV = (TV - min(TV))/(max(TV)-min(TV)),
nRadio = (radio - min(radio))/(max(radio)-min(radio)),
nNewspaper = (newspaper - min(newspaper))/(max(newspaper)-min(newspaper)),
rand = runif(),) %>%
arrange(rand)
library(dplyr)
library(tidyr)
library(ggplot2)
library(tibble)
library(magrittr)
library(readr)
set.seed(100)
data <- select(Sales,TV,radio,newspaper) %>%
mutate(nSales = (Sales - min(Sales))/(max(Sales)-min(Sales)),
nTV = (TV - min(TV))/(max(TV)-min(TV)),
nRadio = (radio - min(radio))/(max(radio)-min(radio)),
nNewspaper = (newspaper - min(newspaper))/(max(newspaper)-min(newspaper)),
rand = runif(),) %>%
arrange(rand)
set.seed(100)
data <- data %>%
select(Sales,TV,radio,newspaper) %>%
mutate(nSales = (Sales - min(Sales))/(max(Sales)-min(Sales)),
nTV = (TV - min(TV))/(max(TV)-min(TV)),
nRadio = (radio - min(radio))/(max(radio)-min(radio)),
nNewspaper = (newspaper - min(newspaper))/(max(newspaper)-min(newspaper)),
rand = runif(),) %>%
arrange(rand)
set.seed(100)
data <- data %>%
select(Sales,TV,radio,newspaper) %>%
mutate(nSales = (Sales - min(Sales))/(max(Sales)-min(Sales)),
nTV = (TV - min(TV))/(max(TV)-min(TV)),
nRadio = (radio - min(radio))/(max(radio)-min(radio)),
nNewspaper = (newspaper - min(newspaper))/(max(newspaper)-min(newspaper)),
rand = runif(1),) %>%
arrange(rand)
data
set.seed(100)
data <- data %>%
select(Sales,TV,radio,newspaper) %>%
mutate(nSales = (Sales - min(Sales))/(max(Sales)-min(Sales)),
nTV = (TV - min(TV))/(max(TV)-min(TV)),
nRadio = (radio - min(radio))/(max(radio)-min(radio)),
nNewspaper = (newspaper - min(newspaper))/(max(newspaper)-min(newspaper)),
rand = runif(dim(data)[1]),) %>%
arrange(rand)
data
set.seed(100) # To produce reproducible result
data <- data %>%
select(Sales,TV,radio,newspaper) %>%
mutate(nSales = (Sales - min(Sales))/(max(Sales)-min(Sales)),
nTV = (TV - min(TV))/(max(TV)-min(TV)),
nRadio = (radio - min(radio))/(max(radio)-min(radio)),
nNewspaper = (newspaper - min(newspaper))/(max(newspaper)-min(newspaper)),
rand = runif(dim(data)[1]),) %>%
arrange(rand)
head(data)
par(mfrow = c(1,3))
plot(nTV, nSales, main = "nSales vs nTV")
attach(data)
par(mfrow = c(1,3))
plot(nTV, nSales, main = "nSales vs nTV")
plot(nRadio, nSales, main = "nSales vs nRadio")
plot(nNewspaper, nSales, main = "nSales vs nNewspaper")
cor(data)
cor(select(data,nSales,nTV,nRadio,nNewspaper))
library(cars)
library(car)
install.packages("car")
library(car)
library(car)
library(tidyverse)
library(car)
detach("package:carData", unload = TRUE)
library(tidyverse)
library(car)
library(tidyverse)
library(car)
data <- read_csv("Advertising.csv")
attach(data)
str(data)
summary(data)
par(mfrow = c(2,2))
hist(TV,breaks = seq(0,300,30))
hist(radio)
hist(newspaper)
hist(Sales)
?hist
par(mfrow = c(1,3))
plot(TV, Sales, main = "Sales vs TV")
plot(radio, Sales, main = "Sales vs radio")
plot(newspaper, Sales, main = "Sales vs newspaper")
set.seed(100) # To produce reproducible result
data <- data %>%
select(Sales,TV,radio,newspaper) %>%
mutate(nSales = (Sales - min(Sales))/(max(Sales)-min(Sales)),
nTV = (TV - min(TV))/(max(TV)-min(TV)),
nRadio = (radio - min(radio))/(max(radio)-min(radio)),
nNewspaper = (newspaper - min(newspaper))/(max(newspaper)-min(newspaper)),
rand = runif(dim(data)[1]),) %>%
arrange(rand)
head(data)
attach(data)
par(mfrow = c(1,3))
plot(nTV, nSales, main = "nSales vs nTV")
plot(nRadio, nSales, main = "nSales vs nRadio")
plot(nNewspaper, nSales, main = "nSales vs nNewspaper")
cor(select(data,nSales,nTV,nRadio,nNewspaper))
dim(data)
train <- head(data,120)
test <- tail(data,80)
View(test)
rm(c(test,train))
rm(test)
rm(train)
# First we set training control to repeated K-fold cross validation
# with K = 10, and repeats = 3
train.control <- trainControl(method = "repeatedcv",
number = 10, repeats = 3)
library(caret)
# First we set training control to repeated K-fold cross validation
# with K = 10, and repeats = 3
train.control <- trainControl(method = "repeatedcv",
number = 10, repeats = 3)
# Then we train the linear model
model1 <- train(nSales ~ sqrt(nTV) + nRadio + nNewspaper, data = data, method = "lm",
trControl = train.control)
# Summary of the result
summary(model1)
summary(model1)
print(model1)
set.seed(100) # To produce reproducible result
data <- data %>%
select(Sales,TV,radio,newspaper) %>%
mutate(rand = runif(dim(data)[1]),) %>%
arrange(rand)
head(data)
cor(select(data,-rand))
# First we set training control to repeated K-fold cross validation
# with K = 10, and repeats = 3
train.control <- trainControl(method = "repeatedcv",
number = 10, repeats = 3)
# Then we train the linear model
model1 <- train(Sales ~ sqrt(TV) + radio + newspaper, data = data, method = "lm",
trControl = train.control)
# Summary of the result
summary(model1)
print(model1)
# First we set training control to repeated K-fold cross validation
# with K = 10, and repeats = 3
train.control <- trainControl(method = "repeatedcv",
number = 10, repeats = 3)
# Then we train the linear model
model1 <- train(Sales ~ sqrt(TV) + radio + newspaper, data = data, method = "lm",
trControl = train.control)
# Summary of the result
summary(model1)
print(model1)
VIF(model1)
vif(model1)
coef(model1)
names(model1)
vif(model1$finalModel)
# Then we train the linear model
model2 <- train(Sales ~ sqrt(TV) + radio, data = data, method = "lm",
trControl = train.control)
# Summary of the result
summary(model2)
print(model2)
vif(model2$finalModel)
plot(model2)
plot(model2$finalModel)
par(mfrow = c(2,2))
plot(model2$finalModel)
# First we set training control to repeated K-fold cross validation
# with K = 10, and repeats = 3
train.control <- trainControl(method = "repeatedcv",
number = 10, repeats = 3)
# Then we train the linear model
model1 <- train(Sales ~ I(sqrt(TV)) + radio + newspaper, data = data, method = "lm",
trControl = train.control)
# Summary of the result
summary(model1)
print(model1)
# Then we train the linear model
model2 <- train(Sales ~ I(sqrt(TV)) + radio, data = data, method = "lm",
trControl = train.control)
# Summary of the result
summary(model2)
print(model2)
anova(model1,model2)
anova(model1$finalModel, model2$finalModel)
library(scatterplot3d)
scatterplot3d(select(data,-rand))
scatterplot3d(x = sqrt(TV), y = radio, z = Sales)
s3d <- scatterplot3d(x = sqrt(TV), y = radio, z = Sales)
s3d <- scatterplot3d(x = sqrt(TV), y = radio, z = Sales)
# adding in the prediction plane
s3d$plane3d(model2$finalModel)
s3d <- scatterplot3d(x = sqrt(TV), y = radio, z = Sales, angle = 55)
# adding in the prediction plane
s3d$plane3d(model2$finalModel)
s3d <- scatterplot3d(x = sqrt(TV), y = radio, z = Sales, angle = 90)
# adding in the prediction plane
s3d$plane3d(model2$finalModel)
s3d <- scatterplot3d(x = sqrt(TV), y = radio, z = Sales, angle = 30)
# adding in the prediction plane
s3d$plane3d(model2$finalModel)
s3d <- scatterplot3d(x = sqrt(TV), y = radio, z = Sales, angle = 45)
# adding in the prediction plane
s3d$plane3d(model2$finalModel)
s3d <- scatterplot3d(x = sqrt(TV), y = radio, z = Sales, angle = 45)
# adding in the prediction plane
s3d$plane3d(model2$finalModel, fill = "red")
s3d <- scatterplot3d(x = sqrt(TV), y = radio, z = Sales, angle = 45)
# adding in the prediction plane
s3d$plane3d(model2$finalModel, col = "red")
?scatterplot3d$plane3d
?scatterplot3d
# adding in the prediction plane
s3d$plane3d(model2$finalModel, lty = "filled")
s3d <- scatterplot3d(x = sqrt(TV), y = radio, z = Sales, angle = 45)
# adding in the prediction plane
s3d$plane3d(model2$finalModel, lty = "filled")
s3d <- scatterplot3d(x = sqrt(TV), y = radio, z = Sales, angle = 45)
# adding in the prediction plane
s3d$plane3d(model2$finalModel, lty = "fill")
s3d <- scatterplot3d(x = sqrt(TV), y = radio, z = Sales, angle = 45)
# adding in the prediction plane
s3d$plane3d(model2$finalModel, lty.box = "solid")
?scatterplot3d
s3d <- scatterplot3d(x = sqrt(TV), y = radio, z = Sales, angle = 45)
# adding in the prediction plane
s3d$plane3d(model2$finalModel, lty = "solid")
?scatterplot3d
s3d <- scatterplot3d(x = sqrt(TV), y = radio, z = Sales, angle = 45)
# adding in the prediction plane
s3d$plane3d(model2$finalModel, lty.box = "solid")
?scatterplot3d
s3d <- scatterplot3d(x = sqrt(TV), y = radio, z = Sales, angle = 45)
# adding in the prediction plane
s3d$plane3d(model2$finalModel, lty = "solid", lty.box = "solid")
?scatterplot3d
s3d <- scatterplot3d(x = sqrt(TV), y = radio, z = Sales, angle = 30)
# adding in the prediction plane
s3d$plane3d(model2$finalModel, lty = "solid", lty.box = "solid")
?scatterplot3d
s3d <- scatterplot3d(x = sqrt(TV), y = radio, z = Sales, angle = 30)
# adding in the prediction plane
s3d$plane3d(model2$finalModel)
# Model with interaction term
model3 <- train(Sales ~ I(sqrt(TV)) * radio, data = data, method = "lm",
trControl = train.control)
# Summary of the result
summary(model3)
print(model3)
# Comparing with model1
anova(model3$finalModel, model1$finalModel)
# Comparing with model1
anova(model1$finalModel, model3$finalModel)
# Comparing with model1
summary(anova(model1$finalModel, model3$finalModel))
# Comparing with model1
anova(model1$finalModel, model3$finalModel)
# Comparing with model1
anova(model1$finalModel, model3$finalModel)
# Comparing with model2
anova(model2$finalModel, model3$finalModel)
# Comparing with model2
anova(model2$finalModel, model3$finalModel)
plot(model3$finalModel)
par(mfrow = c(2,2))
plot(model3$finalModel)
